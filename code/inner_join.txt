# Inner Join - Added column for Diagnosis Description

sql="""SELECT FACT_DIAGNOSIS.NFER_PID, DIAGNOSIS_DIM_DIAGNOSIS_CODE.DIAGNOSIS_METHOD_CODE,
            COUNT(DISTINCT FACT_DIAGNOSIS.NFER_PID) AS COUNT_NFER_PID,
            COUNT(DIAGNOSIS_DIM_DIAGNOSIS_CODE.DIAGNOSIS_METHOD_CODE) AS COUNT_DIAGNOSIS_METHOD_CODE,
            FACT_DIAGNOSIS.INACTIVE_DTM,
            FACT_DIAGNOSIS.AUTO_RESOLVE_DTM,
            FACT_DIAGNOSIS.ONSET_DTM,
            FACT_DIAGNOSIS.NFER_DTM,
            FACT_DIAGNOSIS.DIAGNOSIS_DTM,
            DIAGNOSIS_DIM_DIAGNOSIS_CODE.DIAGNOSIS_CODE,
            DIAGNOSIS_DIM_DIAGNOSIS_CODE.DIAGNOSIS_DESCRIPTION
        FROM FACT DIAGNOSIS
        INNER JOIN DIAGNOSIS_DIM_DIAGNOSIS_CODE
            ON FACT DIAGNOSIS.DIAGNOSIS_CODE_DK = DIAGNOSIS_DIM_DIAGNOSIS_CODE.DIAGNOSIS_CODE_DK
        GROUP BY
            DIAGNOSIS_METHOD_CODE,
            FACT_DIAGNOSIS.NFER_PID,
            FACT_DIAGNOSIS.INACTIVE_DTM,
            FACT_DIAGNOSIS.AUTO_RESOLVE_DTM,
            FACT_DIAGNOSIS.ONSET_DTM,
            FACT_DIAGNOSIS.NFER_DTM,
            FACT_DIAGNOSIS.DIAGNOSIS_DTM,
            DIAGNOSIS_DIM_DIAGNOSIS_CODE.DIAGNOSIS_CODE,
            DIAGNOSIS_DIM_DIAGNOSIS_CODE.DIAGNOSIS_DESCRIPTION;
        """
joined_table=sp.big_query(sql)
joined_table.head()
